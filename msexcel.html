<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Mastery Course</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
   <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <!-- Auth Manager -->
    <script src="auth-manager.js"></script>
    <!-- Add to head section -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1a2b4a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="JOSHCAB INSTITUTE">
<link rel="apple-touch-icon" href="icons/icon-192x192.png">
   <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #217346;
            --primary-dark: #1a5c36;
            --secondary: #2c7c4c;
            --accent: #ff6b00;
            --light: #f8f9fa;
            --dark: #333;
            --gray: #6c757d;
            --border: #e0e0e0;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --mobile-padding: 1rem;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f5f5f5;
            padding-bottom: 80px;
        }

        .container {
            width: 100%;
            max-width: 100%;
            padding: 0;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 1rem var(--mobile-padding);
            text-align: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 1.4rem;
            margin-bottom: 0.3rem;
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .module {
            background: white;
            margin: 1rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        .module-header {
            background: var(--secondary);
            color: white;
            padding: 1rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
        }

        .module-header:hover {
            background: var(--primary-dark);
        }

        .module-header h2 {
            font-size: 1.1rem;
            margin: 0;
        }

        .module-content {
            display: none;
            padding: 0;
        }

        .module-content.active {
            display: block;
        }

        .unit {
            border-bottom: 1px solid var(--border);
        }

        .unit:last-child {
            border-bottom: none;
        }

        .unit-header {
            background: var(--light);
            padding: 1rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background-color 0.3s ease;
        }

        .unit-header:hover {
            background: #e9ecef;
        }

        .unit-header h3 {
            font-size: 1rem;
            margin: 0;
            color: var(--secondary);
        }

        .unit-content {
            display: none;
            padding: 0;
        }

        .unit-content.active {
            display: block;
        }

        .lesson-list {
            list-style: none;
            padding: 0;
        }

        .lesson-item {
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            align-items: center;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }

        .lesson-item:hover {
            background: var(--light);
        }

        .lesson-item:last-child {
            border-bottom: none;
        }

        .lesson-item.completed .lesson-title {
            text-decoration: line-through;
            color: var(--gray);
        }

        .lesson-number {
            background: var(--secondary);
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 1rem;
            flex-shrink: 0;
        }

        .lesson-item.completed .lesson-number {
            background: var(--gray);
        }

        .lesson-title {
            font-size: 0.95rem;
            color: var(--dark);
            flex-grow: 1;
        }

        .lesson-content {
            display: none;
            padding: 1.2rem;
            background: #f9f9f9;
            border-top: 1px solid var(--border);
        }

        .lesson-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .lesson-content h4 {
            color: var(--secondary);
            margin-bottom: 0.5rem;
            font-size: 1.05rem;
            border-bottom: 2px solid var(--accent);
            padding-bottom: 0.5rem;
        }

        .lesson-content p {
            margin-bottom: 1rem;
        }

        .lesson-content ul, .lesson-content ol {
            margin-left: 1.2rem;
            margin-bottom: 1rem;
        }

        .lesson-content li {
            margin-bottom: 0.5rem;
        }

        .keyboard-shortcut {
            display: inline-block;
            background: #e9ecef;
            border: 1px solid #ced4da;
            border-radius: 4px;
            padding: 0.2rem 0.5rem;
            font-family: monospace;
            font-size: 0.85rem;
            margin: 0.2rem;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .code-example {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 1rem;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
            overflow-x: auto;
            border-left: 4px solid var(--accent);
            font-size: 0.9rem;
        }

        .illustration {
            width: 100%;
            max-width: 100%;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid var(--border);
        }

        .tip-box {
            background: #e7f4ff;
            border-left: 4px solid #2196F3;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .icon {
            transition: transform 0.3s ease;
        }

        .icon.rotated {
            transform: rotate(180deg);
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #e0e0e0;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
        }

        .progress {
            height: 100%;
            background: var(--secondary);
            width: 0%;
            transition: width 0.3s ease;
        }

        .nav-buttons {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .nav-btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 0.7rem 1.2rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn:hover {
            background: var(--primary-dark);
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .search-container {
            padding: 0.8rem;
            background: white;
            margin: 0.8rem;
            border-radius: 10px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 100px;
            z-index: 99;
        }

        .search-input {
            width: 100%;
            padding: 0.7rem;
            border: 1px solid #ddd;
            border-radius: 25px;
            font-size: 0.9rem;
            outline: none;
            padding-left: 2.5rem;
        }

        .search-input:focus {
            border-color: var(--secondary);
        }

        .search-icon {
            position: absolute;
            left: 1.8rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }

        .completion-badge {
            background: var(--accent);
            color: white;
            border-radius: 12px;
            padding: 0.2rem 0.6rem;
            font-size: 0.7rem;
            margin-left: 0.5rem;
        }

        /* Mobile-first responsive design */
        @media (max-width: 768px) {
            .header {
                padding: 0.8rem var(--mobile-padding);
            }
            
            .header h1 {
                font-size: 1.2rem;
            }
            
            .module {
                margin: 0.8rem;
            }
            
            .module-header, .unit-header {
                padding: 0.8rem;
            }
            
            .module-header h2 {
                font-size: 1rem;
            }
            
            .unit-header h3 {
                font-size: 0.9rem;
            }
            
            .lesson-item {
                padding: 0.8rem;
            }
            
            .lesson-title {
                font-size: 0.9rem;
            }
            
            .lesson-content {
                padding: 1rem;
            }
            
            .nav-btn {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
            }
            
            .search-container {
                margin: 0.8rem;
                padding: 0.7rem;
            }
            
            .keyboard-shortcut {
                font-size: 0.8rem;
                padding: 0.15rem 0.4rem;
            }
            
            .code-example {
                padding: 0.8rem;
                font-size: 0.85rem;
            }
            
            .tip-box, .warning-box {
                padding: 0.8rem;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.1rem;
            }
            
            .module-header h2 {
                font-size: 0.95rem;
            }
            
            .unit-header h3 {
                font-size: 0.85rem;
            }
            
            .lesson-title {
                font-size: 0.85rem;
            }
            
            .lesson-number {
                width: 24px;
                height: 24px;
                font-size: 0.75rem;
                margin-right: 0.8rem;
            }
            
            .nav-btn {
                padding: 0.5rem 0.8rem;
                font-size: 0.8rem;
            }
        }

        /* Animation for smooth transitions */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .module-content.active,
        .unit-content.active {
            animation: fadeIn 0.3s ease;
        }

        .function-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .function-card {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            border-left: 4px solid var(--secondary);
        }

        .function-card h5 {
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }

        .function-card p {
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .function-syntax {
            background: #f5f5f5;
            padding: 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.8rem;
        }

        .vba-code {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 1rem 0;
            overflow-x: auto;
            border-left: 4px solid #569cd6;
        }

        .vba-keyword {
            color: #569cd6;
        }

        .vba-comment {
            color: #6a9955;
        }

        .vba-string {
            color: #ce9178;
        }

        /* Mobile-specific grid adjustments */
        @media (max-width: 768px) {
            .function-grid {
                grid-template-columns: 1fr;
                gap: 0.8rem;
            }
            
            .function-card {
                padding: 0.8rem;
            }
        }

        /* Enhanced illustration styling */
        .illustration-container {
            position: relative;
            margin: 1.2rem 0;
            text-align: center;
        }

        .illustration-caption {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 0.5rem;
            font-style: italic;
        }

        /* Mobile touch improvements */
        .lesson-item, .module-header, .unit-header {
            -webkit-tap-highlight-color: transparent;
        }

        /* Better mobile scrolling */
        .lesson-content.active {
            max-height: 70vh;
            overflow-y: auto;
        }

        /* Mobile-friendly tables */
        .responsive-table {
            width: 100%;
            overflow-x: auto;
            margin: 1rem 0;
        }

        .responsive-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .responsive-table th, .responsive-table td {
            padding: 0.5rem;
            border: 1px solid var(--border);
            text-align: left;
        }

        .responsive-table th {
            background-color: var(--light);
        }

        .excel-interface {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .excel-interface .component {
            margin-bottom: 0.8rem;
            padding-bottom: 0.8rem;
            border-bottom: 1px dashed #dee2e6;
        }

        .excel-interface .component:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .formula-example {
            background: #e7f3ff;
            border-left: 4px solid #4a90e2;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .formula-example .formula {
            font-family: monospace;
            background: white;
            padding: 0.5rem;
            border-radius: 4px;
            margin: 0.5rem 0;
        }

        .chart-container {
            background: white;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .chart-placeholder {
            height: 200px;
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f7ff 100%);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4a90e2;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="progress-bar">
        <div class="progress" id="progress"></div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Excel Mastery Course</h1>
            <p>From Basics to Advanced Automation</p>
        </div>

        <div class="search-container">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" placeholder="Search Excel functions and features..." id="search-input">
        </div>

        <!-- Module 1: Excel Basics -->
        <div class="module">
            <div class="module-header" onclick="toggleModule(1)">
                <h2>Module 1: Excel Fundamentals</h2>
                <span class="icon">▼</span>
            </div>
            <div class="module-content" id="module-1">
                <!-- Unit 1.1 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(1, 1)">
                        <h3>Unit 1.1: Getting Started with Excel</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-1-1">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(1, 1, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">Introduction to Excel</span>
                            </li>
                            <div class="lesson-content" id="lesson-1-1-1">
                                <h4>What is Microsoft Excel?</h4>
                                <p>Microsoft Excel is a powerful spreadsheet application used for data organization, analysis, and visualization. It's part of the Microsoft Office suite and is widely used in business, finance, and academia.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-table" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Excel spreadsheet with data and charts</div>
                                </div>
                                
                                <p><strong>Key Excel Features:</strong></p>
                                <ul>
                                    <li>Data entry and organization in rows and columns</li>
                                    <li>Mathematical calculations and formulas</li>
                                    <li>Data visualization with charts and graphs</li>
                                    <li>Data analysis tools and pivot tables</li>
                                    <li>Automation with macros and VBA</li>
                                </ul>
                                
                                <div class="tip-box">
                                    <strong>Excel Versions:</strong> This course covers Excel 2016 and later versions, including Excel for Microsoft 365. Most features are compatible across versions.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(1, 1, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Excel Interface Overview</span>
                            </li>
                            <div class="lesson-content" id="lesson-1-1-2">
                                <h4>Navigating the Excel Interface</h4>
                                <p>When you open Excel, you'll see several key components that make up the interface:</p>
                                
                                <div class="excel-interface">
                                    <div class="component">
                                        <strong>Ribbon:</strong> The tabbed toolbar at the top containing commands organized into groups
                                    </div>
                                    <div class="component">
                                        <strong>Formula Bar:</strong> Displays and allows editing of cell contents and formulas
                                    </div>
                                    <div class="component">
                                        <strong>Worksheet:</strong> The grid of rows and columns where you enter data
                                    </div>
                                    <div class="component">
                                        <strong>Name Box:</strong> Shows the address of the selected cell or named range
                                    </div>
                                    <div class="component">
                                        <strong>Status Bar:</strong> At the bottom, shows information about the current selection
                                    </div>
                                </div>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-window-maximize" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Excel interface with key components labeled</div>
                                </div>
                                
                                <h4>Ribbon Tabs</h4>
                                <p>The Excel ribbon contains several tabs, each with related commands:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Home</h5>
                                        <p>Clipboard, font, alignment, number formatting, styles, cells, editing</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Insert</h5>
                                        <p>Tables, illustrations, charts, sparklines, filters, links</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Page Layout</h5>
                                        <p>Themes, page setup, scale to fit, sheet options</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Formulas</h5>
                                        <p>Function library, defined names, formula auditing</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data</h5>
                                        <p>Get & transform data, queries, sort & filter, data tools</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Review</h5>
                                        <p>Proofing, comments, protection, ink</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>View</h5>
                                        <p>Workbook views, show, zoom, window, macros</p>
                                    </div>
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(1, 1, 3)">
                                <span class="lesson-number">3</span>
                                <span class="lesson-title">Search and Help Features</span>
                            </li>
                            <div class="lesson-content" id="lesson-1-1-3">
                                <h4>Using Excel's Search and Help</h4>
                                <p>Excel provides powerful search and help features to assist you in finding commands and learning how to use functions.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-search" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Excel's search and help features</div>
                                </div>
                                
                                <h4>Tell Me Search</h4>
                                <p>The "Tell Me" feature helps you find commands quickly:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Accessing Tell Me</h5>
                                        <p>Click the "Tell me what you want to do" box on the ribbon</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Smart Search</h5>
                                        <p>Type what you want to do and Excel suggests commands</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Direct Actions</h5>
                                        <p>Some searches can perform actions directly</p>
                                    </div>
                                </div>
                                
                                <h4>Excel Help System</h4>
                                <p>Access comprehensive help resources:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>F1 Key</h5>
                                        <p>Press F1 to open the Help pane</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Help Button</h5>
                                        <p>Click the question mark icon in the title bar</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Online Resources</h5>
                                        <p>Access Microsoft's extensive online documentation</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Smart Lookup:</strong> Right-click on any term and select "Smart Lookup" to get definitions and online information without leaving Excel.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(1, 1, 4)">
                                <span class="lesson-number">4</span>
                                <span class="lesson-title">Navigating and Selecting Cells</span>
                            </li>
                            <div class="lesson-content" id="lesson-1-1-4">
                                <h4>Moving Around in Excel</h4>
                                <p>Efficient navigation is key to working productively in Excel. Here are the main ways to move around:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Mouse</h5>
                                        <p>Click on any cell to select it</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Arrow Keys</h5>
                                        <p>Move one cell at a time in any direction</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Tab Key</h5>
                                        <p>Move one cell to the right</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Enter Key</h5>
                                        <p>Move one cell down (default behavior)</p>
                                    </div>
                                </div>
                                
                                <h4>Keyboard Shortcuts for Navigation</h4>
                                <p>Using keyboard shortcuts can significantly speed up your work:</p>
                                
                                <div class="responsive-table">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Shortcut</th>
                                                <th>Action</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td><span class="keyboard-shortcut">Ctrl + Home</span></td>
                                                <td>Go to cell A1</td>
                                            </tr>
                                            <tr>
                                                <td><span class="keyboard-shortcut">Ctrl + End</span></td>
                                                <td>Go to the last used cell</td>
                                            </tr>
                                            <tr>
                                                <td><span class="keyboard-shortcut">Page Down</span></td>
                                                <td>Move one screen down</td>
                                            </tr>
                                            <tr>
                                                <td><span class="keyboard-shortcut">Page Up</span></td>
                                                <td>Move one screen up</td>
                                            </tr>
                                            <tr>
                                                <td><span class="keyboard-shortcut">Alt + Page Down</span></td>
                                                <td>Move one screen to the right</td>
                                            </tr>
                                            <tr>
                                                <td><span class="keyboard-shortcut">Alt + Page Up</span></td>
                                                <td>Move one screen to the left</td>
                                            </tr>
                                            <tr>
                                                <td><span class="keyboard-shortcut">Ctrl + Arrow Key</span></td>
                                                <td>Move to the edge of data region</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <h4>Selecting Cells and Ranges</h4>
                                <p>You can select individual cells, ranges, or entire rows/columns:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Single Cell</h5>
                                        <p>Click on the cell</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Range of Cells</h5>
                                        <p>Click and drag, or click first cell then Shift+click last cell</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Non-adjacent Cells</h5>
                                        <p>Click first cell, then Ctrl+click additional cells</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Entire Row/Column</h5>
                                        <p>Click the row number or column letter</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Quick Selection Tip:</strong> To select all cells with data, press <span class="keyboard-shortcut">Ctrl + A</span>. Press it twice to select the entire worksheet.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>

                <!-- Unit 1.2 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(1, 2)">
                        <h3>Unit 1.2: Working with Data</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-1-2">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(1, 2, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">Entering and Editing Data</span>
                            </li>
                            <div class="lesson-content" id="lesson-1-2-1">
                                <h4>Basic Data Entry</h4>
                                <p>Entering data in Excel is straightforward. Simply select a cell and start typing:</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-keyboard" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Entering data into Excel cells</div>
                                </div>
                                
                                <p><strong>Types of Data You Can Enter:</strong></p>
                                <ul>
                                    <li><strong>Text:</strong> Names, labels, descriptions</li>
                                    <li><strong>Numbers:</strong> Values, quantities, measurements</li>
                                    <li><strong>Dates:</strong> Various date formats</li>
                                    <li><strong>Formulas:</strong> Calculations starting with =</li>
                                </ul>
                                
                                <h4>Editing Cell Contents</h4>
                                <p>There are several ways to edit existing cell contents:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Double-click</h5>
                                        <p>Double-click the cell to edit directly in the cell</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Formula Bar</h5>
                                        <p>Select the cell and edit in the formula bar</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>F2 Key</h5>
                                        <p>Select the cell and press F2 to edit</p>
                                    </div>
                                </div>
                                
                                <div class="warning-box">
                                    <strong>Replacing vs Editing:</strong> If you simply start typing in a selected cell, you'll replace all existing content. Use editing methods to modify existing content.
                                </div>
                                
                                <h4>Deleting Data</h4>
                                <p>To remove data from cells:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Delete Key</h5>
                                        <p>Select cells and press Delete to clear contents</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Backspace Key</h5>
                                        <p>Select cells and press Backspace to clear contents</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Right-click Menu</h5>
                                        <p>Right-click and select "Clear Contents"</p>
                                    </div>
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(1, 2, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Adjusting Cells and Formatting</span>
                            </li>
                            <div class="lesson-content" id="lesson-1-2-2">
                                <h4>Adjusting Cell Size</h4>
                                <p>You can adjust row height and column width to better display your data:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>AutoFit</h5>
                                        <p>Double-click the boundary between row numbers or column letters</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Manual Adjustment</h5>
                                        <p>Click and drag the boundary between row numbers or column letters</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Specific Dimensions</h5>
                                        <p>Right-click row/column and select Row Height/Column Width</p>
                                    </div>
                                </div>
                                
                                <h4>Cell Styles and Formatting</h4>
                                <p>Excel provides predefined cell styles for consistent formatting:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Good, Bad, Neutral</h5>
                                        <p>Styles for indicating data quality</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data and Model</h5>
                                        <p>Styles for different types of data</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Titles and Headings</h5>
                                        <p>Styles for section headers</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Themed Cell Styles</h5>
                                        <p>Styles that match your document theme</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Format Painter:</strong> Use the Format Painter tool (Home tab) to quickly copy formatting from one cell to another.
                                </div>
                                
                                <h4>Number Formatting</h4>
                                <p>Control how numbers are displayed using number formats:</p>
                                
                                <div class="responsive-table">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Format</th>
                                                <th>Description</th>
                                                <th>Example</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>General</td>
                                                <td>Default format, displays as entered</td>
                                                <td>1234.5</td>
                                            </tr>
                                            <tr>
                                                <td>Number</td>
                                                <td>With decimal places and optional commas</td>
                                                <td>1,234.50</td>
                                            </tr>
                                            <tr>
                                                <td>Currency</td>
                                                <td>With currency symbol and decimal places</td>
                                                <td>$1,234.50</td>
                                            </tr>
                                            <tr>
                                                <td>Accounting</td>
                                                <td>Aligns currency symbols and decimal points</td>
                                                <td>$ 1,234.50</td>
                                            </tr>
                                            <tr>
                                                <td>Date</td>
                                                <td>Various date display formats</td>
                                                <td>3/14/2023</td>
                                            </tr>
                                            <tr>
                                                <td>Percentage</td>
                                                <td>Multiplies by 100 and adds % symbol</td>
                                                <td>12.35%</td>
                                            </tr>
                                            <tr>
                                                <td>Fraction</td>
                                                <td>Displays as fractions</td>
                                                <td>1/2</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(1, 2, 3)">
                                <span class="lesson-number">3</span>
                                <span class="lesson-title">Basic Formulas</span>
                            </li>
                            <div class="lesson-content" id="lesson-1-2-3">
                                <h4>Introduction to Formulas</h4>
                                <p>Formulas are equations that perform calculations on values in your worksheet. All formulas in Excel begin with an equal sign (=).</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-calculator" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Excel formulas perform calculations on your data</div>
                                </div>
                                
                                <h4>Basic Arithmetic Operators</h4>
                                <p>Excel uses standard mathematical operators for calculations:</p>
                                
                                <div class="responsive-table">
                                    <table>
                                        <thead>
                                            <tr>
                                                <th>Operator</th>
                                                <th>Operation</th>
                                                <th>Example</th>
                                                <th>Result</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>+</td>
                                                <td>Addition</td>
                                                <td>=5+3</td>
                                                <td>8</td>
                                            </tr>
                                            <tr>
                                                <td>-</td>
                                                <td>Subtraction</td>
                                                <td>=10-4</td>
                                                <td>6</td>
                                            </tr>
                                            <tr>
                                                <td>*</td>
                                                <td>Multiplication</td>
                                                <td>=6*7</td>
                                                <td>42</td>
                                            </tr>
                                            <tr>
                                                <td>/</td>
                                                <td>Division</td>
                                                <td>=15/3</td>
                                                <td>5</td>
                                            </tr>
                                            <tr>
                                                <td>^</td>
                                                <td>Exponentiation</td>
                                                <td>=2^3</td>
                                                <td>8</td>
                                            </tr>
                                            <tr>
                                                <td>%</td>
                                                <td>Percentage</td>
                                                <td>=20%</td>
                                                <td>0.2</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                
                                <h4>Creating Simple Formulas</h4>
                                <p>Let's create some basic formulas using cell references:</p>
                                
                                <div class="formula-example">
                                    <p><strong>Example 1: Adding two numbers</strong></p>
                                    <p>If cell A1 contains 10 and cell B1 contains 5:</p>
                                    <div class="formula">=A1+B1</div>
                                    <p>This formula returns 15</p>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example 2: Calculating percentage</strong></p>
                                    <p>If cell A2 contains 75 and cell B2 contains 100:</p>
                                    <div class="formula">=A2/B2</div>
                                    <p>This formula returns 0.75 (format as percentage to show 75%)</p>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example 3: Using multiple operators</strong></p>
                                    <p>If cell A3 contains 10, B3 contains 20, and C3 contains 2:</p>
                                    <div class="formula">=(A3+B3)*C3</div>
                                    <p>This formula returns 60 (10+20=30, then 30×2=60)</p>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Order of Operations:</strong> Excel follows the standard mathematical order of operations: Parentheses, Exponents, Multiplication and Division (left to right), Addition and Subtraction (left to right). Use parentheses to control the order of calculation.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Module 2: Data Management -->
        <div class="module">
            <div class="module-header" onclick="toggleModule(2)">
                <h2>Module 2: Data Management and Analysis</h2>
                <span class="icon">▼</span>
            </div>
            <div class="module-content" id="module-2">
                <!-- Unit 2.1 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(2, 1)">
                        <h3>Unit 2.1: Data Organization</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-2-1">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(2, 1, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">Sorting Data</span>
                            </li>
                            <div class="lesson-content" id="lesson-2-1-1">
                                <h4>Organizing Your Data with Sorting</h4>
                                <p>Sorting allows you to rearrange your data in a specific order, making it easier to analyze and find information.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-sort-amount-down" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Sorting data in ascending or descending order</div>
                                </div>
                                
                                <h4>Basic Sorting</h4>
                                <p>To quickly sort data by a single column:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Ascending Order</h5>
                                        <p>Click the Sort A to Z button (for text) or Sort Smallest to Largest (for numbers)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Descending Order</h5>
                                        <p>Click the Sort Z to A button (for text) or Sort Largest to Smallest (for numbers)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Right-click Method</h5>
                                        <p>Right-click a cell and choose Sort options from the menu</p>
                                    </div>
                                </div>
                                
                                <h4>Custom Sorting</h4>
                                <p>For more complex sorting needs:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Multiple Columns</h5>
                                        <p>Sort by one column, then by another column</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Custom Lists</h5>
                                        <p>Sort by custom order (e.g., High, Medium, Low)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Cell Color/Font Color</h5>
                                        <p>Sort by cell color, font color, or cell icon</p>
                                    </div>
                                </div>
                                
                                <div class="warning-box">
                                    <strong>Important:</strong> Always ensure your entire data range is selected before sorting, or use Excel Tables to automatically maintain data relationships.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(2, 1, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Filtering Data</span>
                            </li>
                            <div class="lesson-content" id="lesson-2-1-2">
                                <h4>Focusing on Relevant Data with Filters</h4>
                                <p>Filtering allows you to display only the rows that meet specific criteria, hiding the rest temporarily.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-filter" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Filtering data to show only relevant information</div>
                                </div>
                                
                                <h4>Applying Basic Filters</h4>
                                <p>To apply filters to your data:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>AutoFilter</h5>
                                        <p>Select your data and click the Filter button on the Data tab</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Dropdown Arrows</h5>
                                        <p>Click the dropdown arrows in column headers to set filter criteria</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Multiple Criteria</h5>
                                        <p>Apply filters to multiple columns simultaneously</p>
                                    </div>
                                </div>
                                
                                <h4>Filter Types</h4>
                                <p>Excel offers various ways to filter your data:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Text Filters</h5>
                                        <p>Contains, does not contain, begins with, ends with, etc.</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Number Filters</h5>
                                        <p>Greater than, less than, between, top 10, etc.</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Date Filters</h5>
                                        <p>Before, after, between, next week, last month, etc.</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Color Filters</h5>
                                        <p>By cell color, font color, or cell icon</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Quick Filter Tip:</strong> Right-click a cell containing the value you want to filter by and select "Filter > Filter by Selected Cell's Value" for a quick filter.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>

                <!-- Unit 2.2 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(2, 2)">
                        <h3>Unit 2.2: Data Analysis Tools</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-2-2">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(2, 2, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">Conditional Formatting</span>
                            </li>
                            <div class="lesson-content" id="lesson-2-2-1">
                                <h4>Visualizing Data with Conditional Formatting</h4>
                                <p>Conditional formatting automatically applies formatting to cells based on their values, making it easy to spot trends, patterns, and outliers.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-palette" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Conditional formatting highlights important data patterns</div>
                                </div>
                                
                                <h4>Common Conditional Formatting Rules</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Highlight Cells Rules</h5>
                                        <p>Format cells that contain specific values, text, or dates</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Top/Bottom Rules</h5>
                                        <p>Highlight top/bottom items, percentages, or above/below average</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data Bars</h5>
                                        <p>Add colored bars proportional to cell values</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Color Scales</h5>
                                        <p>Apply color gradients (e.g., green-yellow-red)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Icon Sets</h5>
                                        <p>Add icons (arrows, flags, traffic lights) based on value ranges</p>
                                    </div>
                                </div>
                                
                                <h4>Creating Custom Rules</h4>
                                <p>For more advanced conditional formatting, you can create custom rules using formulas:</p>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Highlight weekends</strong></p>
                                    <p>To highlight dates that fall on weekends:</p>
                                    <div class="formula">=WEEKDAY(A1,2)>5</div>
                                    <p>This formula returns TRUE for Saturday (6) and Sunday (7)</p>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Highlight duplicates</strong></p>
                                    <p>To highlight duplicate values in a range:</p>
                                    <div class="formula">=COUNTIF($A$1:$A$10,A1)>1</div>
                                    <p>This formula returns TRUE for values that appear more than once</p>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Managing Rules:</strong> Use the "Manage Rules" option in the Conditional Formatting dropdown to view, edit, or delete all rules in your worksheet.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(2, 2, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Data Validation</span>
                            </li>
                            <div class="lesson-content" id="lesson-2-2-2">
                                <h4>Controlling Data Entry with Validation</h4>
                                <p>Data validation restricts the type of data or values that users can enter into cells, helping maintain data integrity.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-check-circle" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Data validation ensures consistent and accurate data entry</div>
                                </div>
                                
                                <h4>Common Validation Criteria</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Whole Number</h5>
                                        <p>Restrict to whole numbers within a specified range</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Decimal</h5>
                                        <p>Allow decimal numbers within a specified range</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>List</h5>
                                        <p>Create a dropdown list of allowed values</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Date</h5>
                                        <p>Restrict to dates within a specified range</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Time</h5>
                                        <p>Restrict to times within a specified range</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Text Length</h5>
                                        <p>Limit the number of characters</p>
                                    </div>
                                </div>
                                
                                <h4>Creating Dropdown Lists</h4>
                                <p>Dropdown lists are one of the most useful data validation features:</p>
                                
                                <div class="formula-example">
                                    <p><strong>Method 1: Type list directly</strong></p>
                                    <p>Enter allowed values separated by commas:</p>
                                    <div class="formula">Yes,No,Maybe</div>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Method 2: Reference a range</strong></p>
                                    <p>Point to a range containing the allowed values:</p>
                                    <div class="formula">=$D$1:$D$5</div>
                                    <p>This creates a dropdown with values from cells D1 to D5</p>
                                </div>
                                
                                <h4>Input and Error Messages</h4>
                                <p>Customize the user experience with helpful messages:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Input Message</h5>
                                        <p>Display instructions when cell is selected</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Error Alert</h5>
                                        <p>Show custom message when invalid data is entered</p>
                                    </div>
                                </div>
                                
                                <div class="warning-box">
                                    <strong>Note:</strong> Data validation can be circumvented by pasting data. Use worksheet protection to prevent this.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Module 3: Advanced Functions -->
        <div class="module">
            <div class="module-header" onclick="toggleModule(3)">
                <h2>Module 3: Advanced Functions and Formulas</h2>
                <span class="icon">▼</span>
            </div>
            <div class="module-content" id="module-3">
                <!-- Unit 3.1 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(3, 1)">
                        <h3>Unit 3.1: Logical and Lookup Functions</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-3-1">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(3, 1, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">IF and Logical Functions</span>
                            </li>
                            <div class="lesson-content" id="lesson-3-1-1">
                                <h4>Making Decisions with IF Function</h4>
                                <p>The IF function performs a logical test and returns one value if TRUE and another if FALSE.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-code-branch" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">IF function creates conditional logic in your formulas</div>
                                </div>
                                
                                <h4>IF Function Syntax</h4>
                                <div class="code-example">
                                    =IF(logical_test, value_if_true, value_if_false)
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Pass/Fail Grade</strong></p>
                                    <p>If score in A1 is 60 or above, return "Pass", otherwise "Fail":</p>
                                    <div class="formula">=IF(A1>=60, "Pass", "Fail")</div>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Bonus Calculation</strong></p>
                                    <p>If sales in B1 exceed 10000, calculate 10% bonus, otherwise 0:</p>
                                    <div class="formula">=IF(B1>10000, B1*0.1, 0)</div>
                                </div>
                                
                                <h4>Nested IF Functions</h4>
                                <p>You can nest multiple IF functions to handle multiple conditions:</p>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Grade Assignment</strong></p>
                                    <p>Assign letter grades based on score ranges:</p>
                                    <div class="formula">=IF(A1>=90, "A", IF(A1>=80, "B", IF(A1>=70, "C", IF(A1>=60, "D", "F"))))</div>
                                </div>
                                
                                <h4>Other Logical Functions</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>AND</h5>
                                        <p>Returns TRUE if all arguments are TRUE</p>
                                        <div class="function-syntax">=AND(logical1, logical2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>OR</h5>
                                        <p>Returns TRUE if any argument is TRUE</p>
                                        <div class="function-syntax">=OR(logical1, logical2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>NOT</h5>
                                        <p>Reverses the logic of its argument</p>
                                        <div class="function-syntax">=NOT(logical)</div>
                                    </div>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Complex Condition</strong></p>
                                    <p>Check if score is between 70 and 100 (inclusive):</p>
                                    <div class="formula">=IF(AND(A1>=70, A1<=100), "Valid", "Invalid")</div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Modern Alternative:</strong> In newer Excel versions, consider using the IFS function for multiple conditions instead of nested IF functions for cleaner formulas.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(3, 1, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">VLOOKUP and HLOOKUP</span>
                            </li>
                            <div class="lesson-content" id="lesson-3-1-2">
                                <h4>Looking Up Data with VLOOKUP</h4>
                                <p>VLOOKUP searches for a value in the first column of a table and returns a value in the same row from a specified column.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-search" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">VLOOKUP finds and retrieves data from tables</div>
                                </div>
                                
                                <h4>VLOOKUP Syntax</h4>
                                <div class="code-example">
                                    =VLOOKUP(lookup_value, table_array, col_index_num, [range_lookup])
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Product Price Lookup</strong></p>
                                    <p>Look up product ID in A1 and return price from product table:</p>
                                    <div class="formula">=VLOOKUP(A1, $D$1:$F$100, 3, FALSE)</div>
                                    <p>• A1 = Product ID to find<br>• $D$1:$F$100 = Product table (ID in column D)<br>• 3 = Return value from 3rd column (Price)<br>• FALSE = Exact match required</p>
                                </div>
                                
                                <h4>VLOOKUP Arguments Explained</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>lookup_value</h5>
                                        <p>The value to search for in the first column of the table</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>table_array</h5>
                                        <p>The range containing the lookup table</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>col_index_num</h5>
                                        <p>The column number in the table from which to return a value</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>range_lookup</h5>
                                        <p>TRUE = approximate match, FALSE = exact match</p>
                                    </div>
                                </div>
                                
                                <h4>Common VLOOKUP Issues and Solutions</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>#N/A Error</h5>
                                        <p>Lookup value not found. Check spelling or use IFERROR to handle.</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Wrong Column</h5>
                                        <p>Column index number incorrect. Count columns from first table column.</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Approximate Match</h5>
                                        <p>Use FALSE for exact match unless working with sorted numerical data.</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Left Lookup Limitation</h5>
                                        <p>VLOOKUP can't look to the left. Use INDEX/MATCH or XLOOKUP instead.</p>
                                    </div>
                                </div>
                                
                                <h4>HLOOKUP Function</h4>
                                <p>HLOOKUP works like VLOOKUP but searches horizontally across the first row of a table.</p>
                                
                                <div class="code-example">
                                    =HLOOKUP(lookup_value, table_array, row_index_num, [range_lookup])
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Monthly Data Lookup</strong></p>
                                    <p>Look up month name in A1 and return data from specified row:</p>
                                    <div class="formula">=HLOOKUP(A1, $B$1:$M$5, 3, FALSE)</div>
                                    <p>• A1 = Month to find<br>• $B$1:$M$5 = Data table with months in first row<br>• 3 = Return value from 3rd row<br>• FALSE = Exact match required</p>
                                </div>
                                
                                <div class="warning-box">
                                    <strong>Modern Alternative:</strong> Consider using XLOOKUP (in newer Excel versions) which is more flexible and doesn't have VLOOKUP's limitations.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>

                <!-- Unit 3.2 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(3, 2)">
                        <h3>Unit 3.2: Statistical and Date Functions</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-3-2">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(3, 2, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">Statistical Functions</span>
                            </li>
                            <div class="lesson-content" id="lesson-3-2-1">
                                <h4>Analyzing Data with Statistical Functions</h4>
                                <p>Excel provides a comprehensive set of statistical functions for data analysis, from basic counts to advanced statistical measures.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-chart-bar" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Statistical functions help analyze and summarize data</div>
                                </div>
                                
                                <h4>Basic Statistical Functions</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>SUM</h5>
                                        <p>Adds all numbers in a range</p>
                                        <div class="function-syntax">=SUM(number1, number2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>AVERAGE</h5>
                                        <p>Calculates the arithmetic mean</p>
                                        <div class="function-syntax">=AVERAGE(number1, number2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>COUNT</h5>
                                        <p>Counts numbers in a range</p>
                                        <div class="function-syntax">=COUNT(value1, value2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>COUNTA</h5>
                                        <p>Counts non-empty cells</p>
                                        <div class="function-syntax">=COUNTA(value1, value2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>MIN</h5>
                                        <p>Finds the smallest value</p>
                                        <div class="function-syntax">=MIN(number1, number2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>MAX</h5>
                                        <p>Finds the largest value</p>
                                        <div class="function-syntax">=MAX(number1, number2, ...)</div>
                                    </div>
                                </div>
                                
                                <h4>Advanced Statistical Functions</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>MEDIAN</h5>
                                        <p>Finds the middle value in a dataset</p>
                                        <div class="function-syntax">=MEDIAN(number1, number2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>MODE</h5>
                                        <p>Finds the most frequently occurring value</p>
                                        <div class="function-syntax">=MODE(number1, number2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>STDEV</h5>
                                        <p>Calculates standard deviation (sample)</p>
                                        <div class="function-syntax">=STDEV(number1, number2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>STDEVP</h5>
                                        <p>Calculates standard deviation (population)</p>
                                        <div class="function-syntax">=STDEVP(number1, number2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>VAR</h5>
                                        <p>Calculates variance (sample)</p>
                                        <div class="function-syntax">=VAR(number1, number2, ...)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>VARP</h5>
                                        <p>Calculates variance (population)</p>
                                        <div class="function-syntax">=VARP(number1, number2, ...)</div>
                                    </div>
                                </div>
                                
                                <h4>Practical Examples</h4>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Sales Analysis</strong></p>
                                    <p>Analyze monthly sales data in range B2:B13:</p>
                                    <div class="formula">Total Sales: =SUM(B2:B13)</div>
                                    <div class="formula">Average: =AVERAGE(B2:B13)</div>
                                    <div class="formula">Best Month: =MAX(B2:B13)</div>
                                    <div class="formula">Worst Month: =MIN(B2:B13)</div>
                                    <div class="formula">Variation: =STDEV(B2:B13)</div>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Grade Statistics</strong></p>
                                    <p>Analyze student grades in range C2:C50:</p>
                                    <div class="formula">Class Average: =AVERAGE(C2:C50)</div>
                                    <div class="formula">Median Grade: =MEDIAN(C2:C50)</div>
                                    <div class="formula">Most Common Grade: =MODE(C2:C50)</div>
                                    <div class="formula">Passing Students: =COUNTIF(C2:C50,">=60")</div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Quick Analysis:</strong> Select your data range and use the Quick Analysis tool (Ctrl+Q) to instantly see sum, average, count, and other statistics.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(3, 2, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Date and Time Functions</span>
                            </li>
                            <div class="lesson-content" id="lesson-3-2-2">
                                <h4>Working with Dates and Times</h4>
                                <p>Excel stores dates as serial numbers and times as fractional values, making date and time calculations possible.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-calendar-alt" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Date and time functions help manage temporal data</div>
                                </div>
                                
                                <h4>Essential Date Functions</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>TODAY</h5>
                                        <p>Returns current date</p>
                                        <div class="function-syntax">=TODAY()</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>NOW</h5>
                                        <p>Returns current date and time</p>
                                        <div class="function-syntax">=NOW()</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>DATE</h5>
                                        <p>Creates a date from year, month, day</p>
                                        <div class="function-syntax">=DATE(year, month, day)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>DAY</h5>
                                        <p>Extracts day from a date</p>
                                        <div class="function-syntax">=DAY(serial_number)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>MONTH</h5>
                                        <p>Extracts month from a date</p>
                                        <div class="function-syntax">=MONTH(serial_number)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>YEAR</h5>
                                        <p>Extracts year from a date</p>
                                        <div class="function-syntax">=YEAR(serial_number)</div>
                                    </div>
                                </div>
                                
                                <h4>Date Calculation Functions</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>DATEDIF</h5>
                                        <p>Calculates difference between two dates</p>
                                        <div class="function-syntax">=DATEDIF(start_date, end_date, unit)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>EDATE</h5>
                                        <p>Returns date a specified number of months before/after start date</p>
                                        <div class="function-syntax">=EDATE(start_date, months)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>EOMONTH</h5>
                                        <p>Returns last day of month a specified number of months from start date</p>
                                        <div class="function-syntax">=EOMONTH(start_date, months)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>WORKDAY</h5>
                                        <p>Returns date a specified number of workdays before/after start date</p>
                                        <div class="function-syntax">=WORKDAY(start_date, days, holidays)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>NETWORKDAYS</h5>
                                        <p>Calculates number of workdays between two dates</p>
                                        <div class="function-syntax">=NETWORKDAYS(start_date, end_date, holidays)</div>
                                    </div>
                                </div>
                                
                                <h4>Practical Date Examples</h4>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Age Calculation</strong></p>
                                    <p>Calculate age from birth date in A1:</p>
                                    <div class="formula">=DATEDIF(A1, TODAY(), "Y") & " years"</div>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Project Deadline</strong></p>
                                    <p>Calculate project end date (30 workdays from start, excluding holidays):</p>
                                    <div class="formula">=WORKDAY(A2, 30, $H$2:$H$10)</div>
                                    <p>• A2 = Project start date<br>• 30 = Workdays needed<br>• $H$2:$H$10 = Holiday dates</p>
                                </div>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Monthly Reporting</strong></p>
                                    <p>Calculate end of current month:</p>
                                    <div class="formula">=EOMONTH(TODAY(), 0)</div>
                                    <p>Calculate same date next month:</p>
                                    <div class="formula">=EDATE(TODAY(), 1)</div>
                                </div>
                                
                                <h4>Time Functions</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>TIME</h5>
                                        <p>Creates a time from hour, minute, second</p>
                                        <div class="function-syntax">=TIME(hour, minute, second)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>HOUR</h5>
                                        <p>Extracts hour from a time</p>
                                        <div class="function-syntax">=HOUR(serial_number)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>MINUTE</h5>
                                        <p>Extracts minute from a time</p>
                                        <div class="function-syntax">=MINUTE(serial_number)</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>SECOND</h5>
                                        <p>Extracts second from a time</p>
                                        <div class="function-syntax">=SECOND(serial_number)</div>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Date Formatting:</strong> Remember that dates and times are displayed according to your system's regional settings. Use custom formatting (Ctrl+1) to change how they appear.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Module 4: Data Visualization -->
        <div class="module">
            <div class="module-header" onclick="toggleModule(4)">
                <h2>Module 4: Data Visualization and Reporting</h2>
                <span class="icon">▼</span>
            </div>
            <div class="module-content" id="module-4">
                <!-- Unit 4.1 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(4, 1)">
                        <h3>Unit 4.1: Charts and Graphs</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-4-1">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(4, 1, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">Creating Basic Charts</span>
                            </li>
                            <div class="lesson-content" id="lesson-4-1-1">
                                <h4>Visualizing Data with Charts</h4>
                                <p>Charts transform numerical data into visual representations, making patterns, trends, and comparisons easier to understand.</p>
                                
                                <div class="chart-container">
                                    <div class="chart-placeholder">
                                        Sample Chart: Sales Data Visualization
                                    </div>
                                </div>
                                
                                <h4>Common Chart Types</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Column Chart</h5>
                                        <p>Compare values across categories using vertical bars</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Bar Chart</h5>
                                        <p>Compare values across categories using horizontal bars</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Line Chart</h5>
                                        <p>Show trends over time or continuous categories</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Pie Chart</h5>
                                        <p>Show parts of a whole (percentage distribution)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Area Chart</h5>
                                        <p>Show magnitude of change over time</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Scatter Plot</h5>
                                        <p>Show relationship between two variables</p>
                                    </div>
                                </div>
                                
                                <h4>Creating Your First Chart</h4>
                                <p>Follow these steps to create a basic chart:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Step 1: Select Data</h5>
                                        <p>Highlight the data range you want to visualize</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 2: Insert Chart</h5>
                                        <p>Go to Insert tab and choose your chart type</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 3: Customize</h5>
                                        <p>Use Chart Tools to modify design and format</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 4: Position</h5>
                                        <p>Drag chart to desired location on worksheet</p>
                                    </div>
                                </div>
                                
                                <h4>Quick Analysis Tool</h4>
                                <p>Use Excel's Quick Analysis for instant chart creation:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Select Data</h5>
                                        <p>Highlight your data range</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Quick Analysis Button</h5>
                                        <p>Click the button that appears at bottom-right of selection</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Choose Charts</h5>
                                        <p>Select Charts tab and pick recommended chart</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Chart Recommendations:</strong> Excel analyzes your data and suggests the most appropriate chart types. This is a great starting point for beginners.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(4, 1, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Advanced Chart Customization</span>
                            </li>
                            <div class="lesson-content" id="lesson-4-1-2">
                                <h4>Professional Chart Formatting</h4>
                                <p>Transform basic charts into professional, publication-quality visualizations with advanced customization options.</p>
                                
                                <div class="chart-container">
                                    <div class="chart-placeholder">
                                        Customized Chart: Professional Business Report
                                    </div>
                                </div>
                                
                                <h4>Chart Elements and Formatting</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Chart Title</h5>
                                        <p>Descriptive title that explains the chart's purpose</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Axis Titles</h5>
                                        <p>Labels for X and Y axes with units of measurement</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data Labels</h5>
                                        <p>Show exact values on chart elements</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Legend</h5>
                                        <p>Explains colors or patterns used in the chart</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Gridlines</h5>
                                        <p>Help readers estimate values</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Trendline</h5>
                                        <p>Shows overall direction or pattern in data</p>
                                    </div>
                                </div>
                                
                                <h4>Formatting Techniques</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Color Schemes</h5>
                                        <p>Use complementary colors that are accessible</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Font Consistency</h5>
                                        <p>Maintain consistent fonts and sizes</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data Emphasis</h5>
                                        <p>Use contrasting colors to highlight key data</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>White Space</h5>
                                        <p>Allow adequate spacing for readability</p>
                                    </div>
                                </div>
                                
                                <h4>Advanced Chart Types</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Combo Charts</h5>
                                        <p>Combine two chart types (e.g., column and line)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Waterfall Charts</h5>
                                        <p>Show cumulative effect of sequential values</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Histograms</h5>
                                        <p>Show distribution and frequency of data</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Box & Whisker</h5>
                                        <p>Display statistical distribution of data</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Chart Templates:</strong> Save your customized charts as templates to maintain consistency across reports and save time on future chart creation.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(4, 1, 3)">
                                <span class="lesson-number">3</span>
                                <span class="lesson-title">Dynamic and Interactive Charts</span>
                            </li>
                            <div class="lesson-content" id="lesson-4-1-3">
                                <h4>Creating Charts That Update Automatically</h4>
                                <p>Dynamic charts automatically adjust when underlying data changes, making your dashboards and reports more efficient and reliable.</p>
                                
                                <div class="chart-container">
                                    <div class="chart-placeholder">
                                        Dynamic Chart: Auto-updating Dashboard
                                    </div>
                                </div>
                                
                                <h4>Using Excel Tables for Dynamic Charts</h4>
                                <p>The simplest way to create dynamic charts is by using Excel Tables:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Convert to Table</h5>
                                        <p>Select your data and press Ctrl+T</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Create Chart</h5>
                                        <p>Insert chart from the table data</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Add New Data</h5>
                                        <p>Type new data in the row below the table</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Automatic Update</h5>
                                        <p>Chart automatically includes new data</p>
                                    </div>
                                </div>
                                
                                <h4>Dynamic Named Ranges</h4>
                                <p>For more control, use dynamic named ranges with OFFSET or INDEX functions:</p>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Expanding Data Range</strong></p>
                                    <p>Create a named range that expands with new data:</p>
                                    <div class="formula">=OFFSET($A$1,0,0,COUNTA($A:$A),1)</div>
                                    <p>This range starts at A1 and expands down based on how many entries are in column A</p>
                                </div>
                                
                                <h4>Interactive Chart Elements</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Drop-down Menus</h5>
                                        <p>Use data validation to create selection menus</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Checkboxes</h5>
                                        <p>Show/hide data series using form controls</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Scroll Bars</h5>
                                        <p>Navigate through large datasets</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Option Buttons</h5>
                                        <p>Switch between different chart views</p>
                                    </div>
                                </div>
                                
                                <h4>Slicers for Charts</h4>
                                <p>Slicers provide visual filtering for your charts:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Connect to Table</h5>
                                        <p>Ensure your data is in an Excel Table</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Insert Slicer</h5>
                                        <p>Go to Table Design > Insert Slicer</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Style Slicer</h5>
                                        <p>Format to match your dashboard design</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Connect to Charts</h5>
                                        <p>Slicers automatically filter connected charts</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Dashboard Design:</strong> Group related charts and slicers together. Use consistent colors and formatting to create professional-looking dashboards.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>

                <!-- Unit 4.2 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(4, 2)">
                        <h3>Unit 4.2: PivotTables and PivotCharts</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-4-2">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(4, 2, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">PivotTable Fundamentals</span>
                            </li>
                            <div class="lesson-content" id="lesson-4-2-1">
                                <h4>Introduction to PivotTables</h4>
                                <p>PivotTables are powerful tools for summarizing, analyzing, and presenting large datasets. They allow you to extract significance from large, detailed data sets.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-table" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">PivotTables summarize and analyze large datasets efficiently</div>
                                </div>
                                
                                <h4>When to Use PivotTables</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Data Summarization</h5>
                                        <p>Quickly summarize thousands of rows of data</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data Analysis</h5>
                                        <p>Identify patterns and relationships in data</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data Comparison</h5>
                                        <p>Compare related totals and view data from different perspectives</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Reporting</h5>
                                        <p>Create flexible, interactive reports</p>
                                    </div>
                                </div>
                                
                                <h4>Creating Your First PivotTable</h4>
                                <p>Follow these steps to create a basic PivotTable:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Step 1: Prepare Data</h5>
                                        <p>Ensure your data is in a tabular format with headers</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 2: Select Data</h5>
                                        <p>Click anywhere in your data range</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 3: Insert PivotTable</h5>
                                        <p>Go to Insert > PivotTable</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 4: Choose Location</h5>
                                        <p>Select where to place the PivotTable</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 5: Build Layout</h5>
                                        <p>Drag fields to areas in PivotTable Fields pane</p>
                                    </div>
                                </div>
                                
                                <h4>PivotTable Areas</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Filters</h5>
                                        <p>Apply overall filters to the PivotTable</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Columns</h5>
                                        <p>Create columns from unique field values</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Rows</h5>
                                        <p>Create rows from unique field values</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Values</h5>
                                        <p>Calculate and summarize data (sum, count, average, etc.)</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Data Preparation:</strong> For best results, ensure your source data has no blank rows or columns, and each column has a unique header name.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(4, 2, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Advanced PivotTable Techniques</span>
                            </li>
                            <div class="lesson-content" id="lesson-4-2-2">
                                <h4>Mastering PivotTable Analysis</h4>
                                <p>Advanced PivotTable features enable sophisticated data analysis, calculated fields, grouping, and custom calculations.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-cogs" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Advanced PivotTable features for sophisticated analysis</div>
                                </div>
                                
                                <h4>Value Field Settings</h4>
                                <p>Customize how your data is summarized:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Summarize Values By</h5>
                                        <p>Sum, Count, Average, Max, Min, Product</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Show Values As</h5>
                                        <p>% of Grand Total, % of Column Total, % of Row Total, Running Total, Rank</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Number Formatting</h5>
                                        <p>Apply consistent number formats to values</p>
                                    </div>
                                </div>
                                
                                <h4>Grouping Data</h4>
                                <p>Organize data into meaningful categories:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Date Grouping</h5>
                                        <p>Group dates by years, quarters, months, weeks</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Numeric Grouping</h5>
                                        <p>Group numbers into ranges (e.g., 0-100, 101-200)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Manual Grouping</h5>
                                        <p>Select items and group them manually</p>
                                    </div>
                                </div>
                                
                                <h4>Calculated Fields and Items</h4>
                                <p>Create custom calculations within your PivotTable:</p>
                                
                                <div class="formula-example">
                                    <p><strong>Example: Profit Margin</strong></p>
                                    <p>Add a calculated field for profit margin:</p>
                                    <div class="formula">= (Sales - Cost) / Sales</div>
                                    <p>This creates a new field that calculates profit margin percentage</p>
                                </div>
                                
                                <h4>Slicers and Timelines</h4>
                                <p>Add interactive filtering to your PivotTables:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Slicers</h5>
                                        <p>Visual filters for categorical data</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Timelines</h5>
                                        <p>Specialized slicers for date fields</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Connecting Multiple Tables</h5>
                                        <p>Use one slicer to filter multiple PivotTables</p>
                                    </div>
                                </div>
                                
                                <h4>PivotTable Styles and Layouts</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Built-in Styles</h5>
                                        <p>Choose from professional design templates</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Custom Styles</h5>
                                        <p>Create and save your own style templates</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Report Layouts</h5>
                                        <p>Compact, Outline, or Tabular form</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Blank rows</h5>
                                        <p>Insert blank lines between items for readability</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Refresh Data:</strong> Remember to refresh your PivotTable (Right-click > Refresh) when the source data changes. For automatic refreshing, use Excel Tables as your data source.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(4, 2, 3)">
                                <span class="lesson-number">3</span>
                                <span class="lesson-title">PivotCharts and Dashboards</span>
                            </li>
                            <div class="lesson-content" id="lesson-4-2-3">
                                <h4>Visualizing PivotTable Data</h4>
                                <p>PivotCharts combine the analytical power of PivotTables with the visual impact of charts, creating dynamic and interactive visualizations.</p>
                                
                                <div class="chart-container">
                                    <div class="chart-placeholder">
                                        PivotChart: Interactive Data Visualization
                                    </div>
                                </div>
                                
                                <h4>Creating PivotCharts</h4>
                                <p>Multiple ways to create PivotCharts:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>From PivotTable</h5>
                                        <p>Select any cell in PivotTable > Insert > PivotChart</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Direct from Data</h5>
                                        <p>Select source data > Insert > PivotChart</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Recommended PivotCharts</h5>
                                        <p>Let Excel suggest appropriate chart types</p>
                                    </div>
                                </div>
                                
                                <h4>PivotChart Features</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Interactive Filtering</h5>
                                        <p>Use field buttons to filter data directly on chart</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Dynamic Updates</h5>
                                        <p>Chart automatically updates when PivotTable changes</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Multiple Chart Types</h5>
                                        <p>Most Excel chart types available for PivotCharts</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Slicer Connections</h5>
                                        <p>Connect to slicers for coordinated filtering</p>
                                    </div>
                                </div>
                                
                                <h4>Building Interactive Dashboards</h4>
                                <p>Combine multiple PivotTables and PivotCharts to create comprehensive dashboards:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Layout Planning</h5>
                                        <p>Sketch dashboard layout before building</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Consistent Design</h5>
                                        <p>Use uniform colors, fonts, and styles</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Centralized Filtering</h5>
                                        <p>Place slicers in prominent location</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Key Metrics</h5>
                                        <p>Highlight important KPIs and metrics</p>
                                    </div>
                                </div>
                                
                                <h4>Dashboard Best Practices</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Audience Focus</h5>
                                        <p>Design for your specific audience's needs</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Simplicity</h5>
                                        <p>Avoid clutter - show only essential information</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Visual Hierarchy</h5>
                                        <p>Guide viewer's eye to most important elements</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Mobile Consideration</h5>
                                        <p>Ensure readability on different screen sizes</p>
                                    </div>
                                </div>
                                
                                <h4>Advanced Dashboard Techniques</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Conditional Formatting</h5>
                                        <p>Use in PivotTables to highlight trends and outliers</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>KPI Indicators</h5>
                                        <p>Create visual indicators for performance metrics</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Dynamic Titles</h5>
                                        <p>Use formulas to create titles that update with filters</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Navigation Buttons</h5>
                                        <p>Add buttons to switch between different views</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Dashboard Protection:</strong> Protect your dashboard worksheet to prevent accidental changes while allowing filtering and interaction.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Module 5: Excel Automation and Advanced Features -->
        <div class="module">
            <div class="module-header" onclick="toggleModule(5)">
                <h2>Module 5: Excel Automation and Advanced Features</h2>
                <span class="icon">▼</span>
            </div>
            <div class="module-content" id="module-5">
                <!-- Unit 5.1 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(5, 1)">
                        <h3>Unit 5.1: Macros and VBA Fundamentals</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-5-1">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(5, 1, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">Introduction to Macros and VBA</span>
                            </li>
                            <div class="lesson-content" id="lesson-5-1-1">
                                <h4>Automating Excel with Macros</h4>
                                <p>Macros are recorded sequences of Excel commands that can be played back to automate repetitive tasks. VBA (Visual Basic for Applications) is the programming language behind macros that enables advanced automation.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-robot" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Macros automate repetitive tasks in Excel</div>
                                </div>
                                
                                <h4>What You Can Automate with Macros</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Formatting Tasks</h5>
                                        <p>Apply consistent formatting across multiple worksheets</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data Processing</h5>
                                        <p>Clean, transform, and analyze data automatically</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Report Generation</h5>
                                        <p>Create standardized reports with one click</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Complex Calculations</h5>
                                        <p>Perform multi-step calculations automatically</p>
                                    </div>
                                </div>
                                
                                <h4>Enabling the Developer Tab</h4>
                                <p>To work with macros, you need to enable the Developer tab:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Step 1: File Menu</h5>
                                        <p>Click File > Options</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 2: Customize Ribbon</h5>
                                        <p>Select Customize Ribbon from left pane</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 3: Enable Developer</h5>
                                        <p>Check the Developer box in right pane</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 4: Apply</h5>
                                        <p>Click OK to save changes</p>
                                    </div>
                                </div>
                                
                                <h4>Macro Security Settings</h4>
                                <p>Understand and configure macro security:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Disable All Macros</h5>
                                        <p>Highest security - no macros run</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Disable with Notification</h5>
                                        <p>Medium security - user can enable macros</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Enable All Macros</h5>
                                        <p>Low security - all macros run automatically</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Trusted Locations</h5>
                                        <p>Macros in trusted folders run without warnings</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Security First:</strong> Always use "Disable with Notification" as your default setting and only enable macros from trusted sources.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(5, 1, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Recording and Running Macros</span>
                            </li>
                            <div class="lesson-content" id="lesson-5-1-2">
                                <h4>Creating Macros with the Recorder</h4>
                                <p>The Macro Recorder captures your Excel actions and converts them into VBA code, making automation accessible without programming knowledge.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-record-vinyl" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Record macros to automate repetitive tasks</div>
                                </div>
                                
                                <h4>Recording Your First Macro</h4>
                                <p>Follow these steps to record a simple formatting macro:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Step 1: Prepare</h5>
                                        <p>Set up your data as it would be before the task</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 2: Start Recording</h5>
                                        <p>Developer tab > Record Macro</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 3: Name Macro</h5>
                                        <p>Give it a descriptive name without spaces</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 4: Perform Actions</h5>
                                        <p>Complete the tasks you want to automate</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 5: Stop Recording</h5>
                                        <p>Developer tab > Stop Recording</p>
                                    </div>
                                </div>
                                
                                <h4>Macro Recording Options</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Macro Name</h5>
                                        <p>Use descriptive names like "FormatSalesReport"</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Shortcut Key</h5>
                                        <p>Assign Ctrl+letter to run macro quickly</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Store Macro In</h5>
                                        <p>This Workbook, Personal Macro Workbook, or New Workbook</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Description</h5>
                                        <p>Add notes about what the macro does</p>
                                    </div>
                                </div>
                                
                                <h4>Running Recorded Macros</h4>
                                <p>Multiple ways to execute your macros:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Macros Dialog</h5>
                                        <p>Developer tab > Macros > Select macro > Run</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Shortcut Key</h5>
                                        <p>Use the Ctrl+letter combination you assigned</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Button</h5>
                                        <p>Assign macro to a form control button</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Quick Access Toolbar</h5>
                                        <p>Add macro to QAT for one-click access</p>
                                    </div>
                                </div>
                                
                                <h4>Viewing and Editing Recorded Code</h4>
                                <p>Examine the VBA code generated by the recorder:</p>
                                
                                <div class="vba-code">
                                    <span class="vba-keyword">Sub</span> FormatSalesReport()<br>
                                    <span class="vba-keyword">'</span><br>
                                    <span class="vba-keyword">'</span> FormatSalesReport Macro<br>
                                    <span class="vba-keyword">'</span> Format the sales report with company standards<br>
                                    <span class="vba-keyword">'</span><br>
                                    <br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;Range(<span class="vba-string">"A1:G1"</span>).Select<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;Selection.Font.Bold = <span class="vba-keyword">True</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;Selection.Interior.Color = RGB(200, 200, 200)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;Columns(<span class="vba-string">"A:G"</span>).AutoFit<br>
                                    <span class="vba-keyword">End Sub</span>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Relative vs Absolute Recording:</strong> Use Relative References when recording macros that should work on different parts of your worksheet. This makes macros more flexible and reusable.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(5, 1, 3)">
                                <span class="lesson-number">3</span>
                                <span class="lesson-title">VBA Programming Basics</span>
                            </li>
                            <div class="lesson-content" id="lesson-5-1-3">
                                <h4>Understanding VBA Syntax and Structure</h4>
                                <p>VBA (Visual Basic for Applications) is the programming language that powers Excel macros. Learning VBA fundamentals enables you to create more powerful and flexible automation solutions.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-code" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">VBA programming extends Excel's automation capabilities</div>
                                </div>
                                
                                <h4>VBA Editor Interface</h4>
                                <p>Get familiar with the Visual Basic Editor (VBE):</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Project Explorer</h5>
                                        <p>Shows all open workbooks and their components</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Properties Window</h5>
                                        <p>Displays properties of selected object</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Code Window</h5>
                                        <p>Where you write and edit VBA code</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Immediate Window</h5>
                                        <p>Test code and debug quickly</p>
                                    </div>
                                </div>
                                
                                <h4>Basic VBA Syntax Elements</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Sub Procedures</h5>
                                        <p>Blocks of code that perform actions</p>
                                        <div class="function-syntax">Sub MacroName() ... End Sub</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>Comments</h5>
                                        <p>Notes for humans, ignored by VBA</p>
                                        <div class="function-syntax">' This is a comment</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>Variables</h5>
                                        <p>Containers for storing data</p>
                                        <div class="function-syntax">Dim x As Integer</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>Objects</h5>
                                        <p>Excel elements like Workbook, Worksheet, Range</p>
                                        <div class="function-syntax">Worksheets("Sheet1")</div>
                                    </div>
                                </div>
                                
                                <h4>Common VBA Objects and Methods</h4>
                                
                                <div class="vba-code">
                                    <span class="vba-comment">' Referencing workbooks and worksheets</span><br>
                                    Workbooks(<span class="vba-string">"MyWorkbook.xlsx"</span>).Worksheets(<span class="vba-string">"Sheet1"</span>)<br>
                                    <span class="vba-comment">' Or use ActiveWorkbook and ActiveSheet</span><br>
                                    ActiveSheet.Range(<span class="vba-string">"A1"</span>)<br>
                                    <br>
                                    <span class="vba-comment">' Working with ranges</span><br>
                                    Range(<span class="vba-string">"A1"</span>).Value = <span class="vba-string">"Hello World"</span><br>
                                    Range(<span class="vba-string">"A1:B10"</span>).Font.Bold = <span class="vba-keyword">True</span><br>
                                    <br>
                                    <span class="vba-comment">' Looping through ranges</span><br>
                                    <span class="vba-keyword">Dim</span> cell <span class="vba-keyword">As</span> Range<br>
                                    <span class="vba-keyword">For Each</span> cell <span class="vba-keyword">In</span> Range(<span class="vba-string">"A1:A10"</span>)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">If</span> cell.Value > 100 <span class="vba-keyword">Then</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cell.Interior.Color = vbYellow<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">End If</span><br>
                                    <span class="vba-keyword">Next</span> cell
                                </div>
                                
                                <h4>Variables and Data Types</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Integer</h5>
                                        <p>Whole numbers from -32,768 to 32,767</p>
                                        <div class="function-syntax">Dim count As Integer</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>Long</h5>
                                        <p>Larger whole numbers</p>
                                        <div class="function-syntax">Dim bigNumber As Long</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>String</h5>
                                        <p>Text data</p>
                                        <div class="function-syntax">Dim name As String</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>Double</h5>
                                        <p>Decimal numbers</p>
                                        <div class="function-syntax">Dim price As Double</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>Boolean</h5>
                                        <p>True or False values</p>
                                        <div class="function-syntax">Dim isComplete As Boolean</div>
                                    </div>
                                    <div class="function-card">
                                        <h5>Variant</h5>
                                        <p>Any type of data (default)</p>
                                        <div class="function-syntax">Dim anything</div>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Option Explicit:</strong> Always use "Option Explicit" at the top of your modules to force variable declaration. This helps catch typos and makes your code more reliable.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>

                <!-- Unit 5.2 -->
                <div class="unit">
                    <div class="unit-header" onclick="toggleUnit(5, 2)">
                        <h3>Unit 5.2: Advanced Automation Techniques</h3>
                        <span class="icon">▼</span>
                    </div>
                    <div class="unit-content" id="unit-5-2">
                        <ul class="lesson-list">
                            <li class="lesson-item" onclick="toggleLesson(5, 2, 1)">
                                <span class="lesson-number">1</span>
                                <span class="lesson-title">User Forms and Controls</span>
                            </li>
                            <div class="lesson-content" id="lesson-5-2-1">
                                <h4>Creating Custom User Interfaces</h4>
                                <p>UserForms provide custom dialog boxes and interfaces for your Excel applications, making them more user-friendly and professional.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-window-restore" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">UserForms create custom interfaces for Excel applications</div>
                                </div>
                                
                                <h4>Creating Your First UserForm</h4>
                                <p>Follow these steps to create a simple data entry form:</p>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Step 1: Insert UserForm</h5>
                                        <p>VBA Editor > Insert > UserForm</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 2: Add Controls</h5>
                                        <p>Drag labels, textboxes, buttons from Toolbox</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 3: Set Properties</h5>
                                        <p>Configure control properties in Properties window</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 4: Write Code</h5>
                                        <p>Add VBA code to handle user interactions</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step 5: Show Form</h5>
                                        <p>Use UserForm1.Show to display the form</p>
                                    </div>
                                </div>
                                
                                <h4>Common Form Controls</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Label</h5>
                                        <p>Display static text</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>TextBox</h5>
                                        <p>Allow user text input</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>ComboBox</h5>
                                        <p>Dropdown selection list</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>ListBox</h5>
                                        <p>List of selectable items</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>CheckBox</h5>
                                        <p>On/off options</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>OptionButton</h5>
                                        <p>Mutually exclusive choices</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>CommandButton</h5>
                                        <p>Clickable buttons for actions</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Frame</h5>
                                        <p>Group related controls</p>
                                    </div>
                                </div>
                                
                                <h4>UserForm Events and Programming</h4>
                                
                                <div class="vba-code">
                                    <span class="vba-comment">' Initialize form when it loads</span><br>
                                    <span class="vba-keyword">Private Sub</span> UserForm_Initialize()<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Populate combo box</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;ComboBox1.AddItem <span class="vba-string">"Option 1"</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;ComboBox1.AddItem <span class="vba-string">"Option 2"</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;ComboBox1.AddItem <span class="vba-string">"Option 3"</span><br>
                                    <span class="vba-keyword">End Sub</span><br>
                                    <br>
                                    <span class="vba-comment">' Handle OK button click</span><br>
                                    <span class="vba-keyword">Private Sub</span> CommandButton1_Click()<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Transfer data to worksheet</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;Range(<span class="vba-string">"A1"</span>).Value = TextBox1.Value<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;Range(<span class="vba-string">"B1"</span>).Value = ComboBox1.Value<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Close form</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;Unload <span class="vba-keyword">Me</span><br>
                                    <span class="vba-keyword">End Sub</span>
                                </div>
                                
                                <h4>Form Control Properties</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Name</h5>
                                        <p>Unique identifier for coding (e.g., txtName)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Caption</h5>
                                        <p>Text displayed to user</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Value</h5>
                                        <p>Current content of control</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Enabled</h5>
                                        <p>Whether control is active</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Visible</h5>
                                        <p>Whether control is shown</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>TabIndex</h5>
                                        <p>Order of focus when tabbing</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Control Naming Convention:</strong> Use consistent prefixes for control names (txt for TextBox, cmd for CommandButton, lbl for Label) to make your code more readable and maintainable.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(5, 2, 2)">
                                <span class="lesson-number">2</span>
                                <span class="lesson-title">Error Handling and Debugging</span>
                            </li>
                            <div class="lesson-content" id="lesson-5-2-2">
                                <h4>Creating Robust VBA Applications</h4>
                                <p>Proper error handling ensures your macros run smoothly even when unexpected situations occur, while debugging techniques help you find and fix problems in your code.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-bug" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Error handling and debugging create reliable VBA applications</div>
                                </div>
                                
                                <h4>Common VBA Error Types</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Compile Errors</h5>
                                        <p>Syntax errors that prevent code from running</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Runtime Errors</h5>
                                        <p>Errors that occur during code execution</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Logical Errors</h5>
                                        <p>Code runs but produces wrong results</p>
                                    </div>
                                </div>
                                
                                <h4>Basic Error Handling with On Error</h4>
                                
                                <div class="vba-code">
                                    <span class="vba-comment">' Simple error handling</span><br>
                                    <span class="vba-keyword">Sub</span> BasicErrorHandling()<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">On Error GoTo</span> ErrorHandler<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Main code that might cause errors</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;Workbooks.Open <span class="vba-string">"C:\NonExistentFile.xlsx"</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Exit before error handler if no errors</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Exit Sub</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    ErrorHandler:<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;MsgBox <span class="vba-string">"An error occurred: "</span> & Err.Description<br>
                                    <span class="vba-keyword">End Sub</span>
                                </div>
                                
                                <h4>Advanced Error Handling Techniques</h4>
                                
                                <div class="vba-code">
                                    <span class="vba-comment">' More sophisticated error handling</span><br>
                                    <span class="vba-keyword">Sub</span> AdvancedErrorHandling()<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">On Error GoTo</span> ErrorHandler<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Your main code here</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' ...</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Exit Sub</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    ErrorHandler:<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Select Case</span> Err.Number<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Case</span> 9 <span class="vba-comment">' Subscript out of range</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox <span class="vba-string">"Worksheet not found!"</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Case</span> 1004 <span class="vba-comment">' Application-defined error</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox <span class="vba-string">"Cannot access file. Is it open?"</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Case Else</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MsgBox <span class="vba-string">"Error "</span> & Err.Number & <span class="vba-string">": "</span> & Err.Description<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">End Select</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Resume or exit based on error severity</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">If</span> Err.Number = 9 <span class="vba-keyword">Then</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Resume Next<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Else</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">End</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">End If</span><br>
                                    <span class="vba-keyword">End Sub</span>
                                </div>
                                
                                <h4>Debugging Tools and Techniques</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Breakpoints</h5>
                                        <p>Pause execution at specific lines (F9)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Step Through</h5>
                                        <p>Execute code line by line (F8)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Immediate Window</h5>
                                        <p>Test code and check values (Ctrl+G)</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Watch Window</h5>
                                        <p>Monitor variable values during execution</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Locals Window</h5>
                                        <p>View all variables in current procedure</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Call Stack</h5>
                                        <p>See sequence of procedure calls</p>
                                    </div>
                                </div>
                                
                                <h4>Preventive Coding Practices</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Variable Declaration</h5>
                                        <p>Always use Option Explicit</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Data Validation</h5>
                                        <p>Check inputs before processing</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Existence Checks</h5>
                                        <p>Verify files, sheets, ranges exist</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Error Trapping</h5>
                                        <p>Use On Error statements appropriately</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Debug.Print:</strong> Use Debug.Print statements to output values to the Immediate Window without interrupting code execution. This is great for tracking variable changes and program flow.
                                </div>
                            </div>

                            <li class="lesson-item" onclick="toggleLesson(5, 2, 3)">
                                <span class="lesson-number">3</span>
                                <span class="lesson-title">Advanced VBA Projects</span>
                            </li>
                            <div class="lesson-content" id="lesson-5-2-3">
                                <h4>Building Professional Excel Applications</h4>
                                <p>Combine VBA skills to create sophisticated Excel applications that automate complex business processes, generate reports, and provide custom functionality.</p>
                                
                                <div class="illustration-container">
                                    <div class="illustration" style="background-color:#f0f0f0;height:200px;display:flex;align-items:center;justify-content:center;color:#666;">
                                        <i class="fas fa-project-diagram" style="font-size:3rem;"></i>
                                    </div>
                                    <div class="illustration-caption">Advanced VBA projects automate complex business processes</div>
                                </div>
                                
                                <h4>Project: Automated Reporting System</h4>
                                <p>Create a system that generates customized reports from raw data:</p>
                                
                                <div class="vba-code">
                                    <span class="vba-keyword">Sub</span> GenerateMonthlyReport()<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Dim</span> wsData <span class="vba-keyword">As</span> Worksheet, wsReport <span class="vba-keyword">As</span> Worksheet<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Dim</span> lastRow <span class="vba-keyword">As</span> Long, i <span class="vba-keyword">As</span> Long<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Error handling</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">On Error GoTo</span> ErrorHandler<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Set worksheet references</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Set</span> wsData = Worksheets(<span class="vba-string">"RawData"</span>)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Set</span> wsReport = Worksheets(<span class="vba-string">"MonthlyReport"</span>)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Clear previous report</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;wsReport.Cells.Clear<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Find last row of data</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;lastRow = wsData.Cells(wsData.Rows.Count, <span class="vba-string">"A"</span>).End(xlUp).Row<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Process data and create report</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Call</span> ProcessData(wsData, wsReport, lastRow)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Call</span> FormatReport(wsReport)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Call</span> CreateCharts(wsReport)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;MsgBox <span class="vba-string">"Monthly report generated successfully!"</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Exit Sub</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    ErrorHandler:<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;MsgBox <span class="vba-string">"Error generating report: "</span> & Err.Description<br>
                                    <span class="vba-keyword">End Sub</span>
                                </div>
                                
                                <h4>Project: Data Import and Cleaning Tool</h4>
                                <p>Create an application that imports data from external sources and cleans it automatically:</p>
                                
                                <div class="vba-code">
                                    <span class="vba-keyword">Sub</span> ImportAndCleanData()<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Dim</span> sourceFile <span class="vba-keyword">As</span> String<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Dim</span> importWb <span class="vba-keyword">As</span> Workbook<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Get source file using file dialog</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;sourceFile = GetFileFromDialog()<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">If</span> sourceFile = <span class="vba-string">""</span> <span class="vba-keyword">Then Exit Sub</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Import data</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Set</span> importWb = Workbooks.Open(sourceFile)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;importWb.Sheets(1).Copy After:=ThisWorkbook.Sheets(1)<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;importWb.Close <span class="vba-keyword">False</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-comment">' Clean imported data</span><br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Call</span> RemoveEmptyRows<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Call</span> StandardizeDateFormat<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<span class="vba-keyword">Call</span> ValidateAndFlagErrors<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;<br>
                                    &nbsp;&nbsp;&nbsp;&nbsp;MsgBox <span class="vba-string">"Data imported and cleaned successfully!"</span><br>
                                    <span class="vba-keyword">End Sub</span>
                                </div>
                                
                                <h4>Advanced Techniques</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Class Modules</h5>
                                        <p>Create custom objects with properties and methods</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>API Calls</h5>
                                        <p>Interact with Windows API for advanced functionality</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Database Connectivity</h5>
                                        <p>Connect to external databases using ADO</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>XML/JSON Processing</h5>
                                        <p>Work with web services and structured data</p>
                                    </div>
                                </div>
                                
                                <h4>Application Design Best Practices</h4>
                                
                                <div class="function-grid">
                                    <div class="function-card">
                                        <h5>Modular Design</h5>
                                        <p>Break code into logical, reusable procedures</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>User Interface</h5>
                                        <p>Create intuitive interfaces with clear navigation</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Documentation</h5>
                                        <p>Include comments and user guides</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Error Handling</h5>
                                        <p>Implement comprehensive error management</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Performance</h5>
                                        <p>Optimize code for speed and efficiency</p>
                                    </div>
                                    <div class="function-card">
                                        <h5>Security</h5>
                                        <p>Protect sensitive data and code</p>
                                    </div>
                                </div>
                                
                                <div class="tip-box">
                                    <strong>Code Organization:</strong> Use separate modules for different functionalities (e.g., one module for data processing, another for UI, another for utilities). This makes your code easier to maintain and reuse.
                                </div>
                            </div>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="nav-buttons">
        <button class="nav-btn" id="prev-btn" onclick="navigateLesson('prev')">
            <i class="fas fa-arrow-left"></i> Previous
        </button>
        <button class="nav-btn" id="next-btn" onclick="navigateLesson('next')">
            Next <i class="fas fa-arrow-right"></i>
        </button>
    </div>

    <script>
        // Track current lesson
        let currentLesson = null;

        // Toggle module visibility
        function toggleModule(moduleId) {
            const moduleContent = document.getElementById(`module-${moduleId}`);
            const icon = moduleContent.previousElementSibling.querySelector('.icon');
            
            moduleContent.classList.toggle('active');
            icon.classList.toggle('rotated');
            
            // Close other modules when opening a new one (optional)
            // document.querySelectorAll('.module-content').forEach((content, index) => {
            //     if (index + 1 !== moduleId && content.classList.contains('active')) {
            //         content.classList.remove('active');
            //         content.previousElementSibling.querySelector('.icon').classList.remove('rotated');
            //     }
            // });
        }

        // Toggle unit visibility
        function toggleUnit(moduleId, unitId) {
            const unitContent = document.getElementById(`unit-${moduleId}-${unitId}`);
            const icon = unitContent.previousElementSibling.querySelector('.icon');
            
            unitContent.classList.toggle('active');
            icon.classList.toggle('rotated');
        }

        // Toggle lesson content
        function toggleLesson(moduleId, unitId, lessonId) {
            const lessonContent = document.getElementById(`lesson-${moduleId}-${unitId}-${lessonId}`);
            
            // Close other lessons in the same unit
            const unitContent = document.getElementById(`unit-${moduleId}-${unitId}`);
            unitContent.querySelectorAll('.lesson-content').forEach(content => {
                if (content !== lessonContent && content.classList.contains('active')) {
                    content.classList.remove('active');
                }
            });
            
            // Toggle current lesson
            lessonContent.classList.toggle('active');
            
            // Update current lesson tracking
            if (lessonContent.classList.contains('active')) {
                currentLesson = { moduleId, unitId, lessonId };
                updateProgress();
            }
        }

        // Update progress bar
        function updateProgress() {
            // Simple progress calculation - count all lessons and completed ones
            const totalLessons = document.querySelectorAll('.lesson-item').length;
            const completedLessons = document.querySelectorAll('.lesson-item.completed').length;
            const progressPercentage = (completedLessons / totalLessons) * 100;
            
            document.getElementById('progress').style.width = `${progressPercentage}%`;
        }

        // Navigate between lessons
        function navigateLesson(direction) {
            if (!currentLesson) return;
            
            const { moduleId, unitId, lessonId } = currentLesson;
            let nextLesson;
            
            if (direction === 'next') {
                // Find next lesson in current unit
                const currentUnit = document.getElementById(`unit-${moduleId}-${unitId}`);
                const lessons = currentUnit.querySelectorAll('.lesson-item');
                const currentIndex = Array.from(lessons).findIndex(lesson => 
                    lesson.getAttribute('onclick').includes(`toggleLesson(${moduleId}, ${unitId}, ${lessonId})`)
                );
                
                if (currentIndex < lessons.length - 1) {
                    nextLesson = lessons[currentIndex + 1];
                } else {
                    // Move to next unit or module
                    // This is a simplified implementation
                    alert('You have reached the end of this unit!');
                    return;
                }
            } else {
                // Find previous lesson in current unit
                const currentUnit = document.getElementById(`unit-${moduleId}-${unitId}`);
                const lessons = currentUnit.querySelectorAll('.lesson-item');
                const currentIndex = Array.from(lessons).findIndex(lesson => 
                    lesson.getAttribute('onclick').includes(`toggleLesson(${moduleId}, ${unitId}, ${lessonId})`)
                );
                
                if (currentIndex > 0) {
                    nextLesson = lessons[currentIndex - 1];
                } else {
                    // Move to previous unit or module
                    alert('You are at the beginning of this unit!');
                    return;
                }
            }
            
            // Close current lesson and open next one
            document.querySelectorAll('.lesson-content.active').forEach(content => {
                content.classList.remove('active');
            });
            
            // Extract lesson IDs from onclick attribute
            const onclickAttr = nextLesson.getAttribute('onclick');
            const matches = onclickAttr.match(/toggleLesson\((\d+), (\d+), (\d+)\)/);
            if (matches) {
                const [, nextModuleId, nextUnitId, nextLessonId] = matches;
                const nextLessonContent = document.getElementById(`lesson-${nextModuleId}-${nextUnitId}-${nextLessonId}`);
                nextLessonContent.classList.add('active');
                currentLesson = { moduleId: parseInt(nextModuleId), unitId: parseInt(nextUnitId), lessonId: parseInt(nextLessonId) };
                
                // Scroll to the lesson
                nextLessonContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Search functionality
        document.getElementById('search-input').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            
            if (searchTerm.length < 2) {
                // Reset display if search term is too short
                document.querySelectorAll('.module, .unit, .lesson-item').forEach(element => {
                    element.style.display = '';
                });
                return;
            }
            
            // Search through lesson titles and content
            document.querySelectorAll('.lesson-item').forEach(lesson => {
                const lessonTitle = lesson.querySelector('.lesson-title').textContent.toLowerCase();
                const lessonId = lesson.getAttribute('onclick').match(/toggleLesson\((\d+), (\d+), (\d+)\)/);
                
                if (lessonId) {
                    const [, moduleId, unitId, lessonIdNum] = lessonId;
                    const lessonContent = document.getElementById(`lesson-${moduleId}-${unitId}-${lessonIdNum}`);
                    const contentText = lessonContent.textContent.toLowerCase();
                    
                    if (lessonTitle.includes(searchTerm) || contentText.includes(searchTerm)) {
                        // Show this lesson and its parents
                        lesson.style.display = '';
                        lesson.closest('.unit').style.display = '';
                        lesson.closest('.module').style.display = '';
                    } else {
                        lesson.style.display = 'none';
                    }
                }
            });
        });

        // Mark lesson as completed (example functionality)
        document.querySelectorAll('.lesson-item').forEach(lesson => {
            lesson.addEventListener('dblclick', function() {
                this.classList.toggle('completed');
                updateProgress();
            });
        });

        // Initialize first module as open
        document.addEventListener('DOMContentLoaded', function() {
            toggleModule(1);
            updateProgress();
        });
    </script>
    <!-- Add to head section -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1a2b4a">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="JOSHCAB Training">
<link rel="apple-touch-icon" href="icons/icon-192x192.png">

<!-- Add to body section (before closing body tag) -->
<script>
    // Register service worker
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/service-worker.js')
                .then(function(registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                    
                    // Check for updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        console.log('New service worker found...');
                        
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                console.log('New content available; please refresh.');
                                // You can show an update notification here
                                showUpdateNotification();
                            }
                        });
                    });
                })
                .catch(function(error) {
                    console.log('ServiceWorker registration failed: ', error);
                });
        });

        // Listen for claiming of service worker
        let refreshing = false;
        navigator.serviceWorker.addEventListener('controllerchange', () => {
            if (!refreshing) {
                window.location.reload();
                refreshing = true;
            }
        });
    }

    // Function to show update notification
    function showUpdateNotification() {
        if (confirm('New version available! Would you like to update?')) {
            window.location.reload();
        }
    }

    // Online/offline status detection
    window.addEventListener('online', function() {
        console.log('App is online');
        // You can show a notification that app is back online
        showOnlineStatus();
    });

    window.addEventListener('offline', function() {
        console.log('App is offline');
        showOfflineStatus();
    });

    function showOnlineStatus() {
        // Create a subtle notification
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 70px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 10000;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        `;
        notification.innerHTML = '<i class="fas fa-wifi"></i> Back online';
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }

    function showOfflineStatus() {
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 70px;
            right: 20px;
            background: #e74c3c;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 10000;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        `;
        notification.innerHTML = '<i class="fas fa-wifi-slash"></i> You are offline';
        document.body.appendChild(notification);
        
        setTimeout(() => {
            notification.remove();
        }, 3000);
    }
</script>
</body>
</html>